# Реализация динамического переключения языка

## Обзор

Реализована функциональность динамического переключения языка интерфейса без перезапуска приложения.

## Изменения

### 1. Добавлена кнопка USA для английского языка

В `ui/settings_window.py`:
- Добавлена кнопка "US" (USA) для английского языка
- Теперь есть две кнопки для английского: GB и US
- Обе кнопки устанавливают язык `"en"`
- Всего 16 кнопок языков (было 15)

### 2. Исправлена обработка кавычек в конфигурации

В `core/config.py`:
- Добавлена автоматическая очистка кавычек при загрузке `INTERFACE_LANGUAGE`
- Добавлена автоматическая очистка кавычек при загрузке `RECORDINGS_PATH`
- Используется `.strip().strip("'\"")`

### 3. Реализовано динамическое переключение языка

В `ui/settings_window.py` добавлены методы:

#### `_reload_ui_texts()`
Перезагружает все тексты в интерфейсе после смены языка:
- Обновляет заголовок окна
- Обновляет боковую панель
- Обновляет кнопки
- Пересоздает все страницы с новыми переводами
- Сохраняет и восстанавливает значения полей

#### `_get_current_values()`
Сохраняет текущие значения всех полей перед перезагрузкой интерфейса.

#### `_restore_current_values(values)`
Восстанавливает значения всех полей после перезагрузки интерфейса.

#### Обновлен `_save_settings()`
- Определяет, изменился ли язык
- Вызывает `set_language()` для обновления глобального состояния
- Вызывает `_reload_ui_texts()` для обновления интерфейса
- Обновляет конфигурацию

## Как это работает

1. **Пользователь выбирает язык** в настройках
2. **Нажимает "Сохранить"**
3. **Система проверяет**, изменился ли язык
4. **Если изменился**:
   - Сохраняет новый язык в `.env`
   - Вызывает `set_language()` для обновления модуля `i18n`
   - Сохраняет текущие значения всех полей
   - Пересоздает все страницы с новыми переводами
   - Восстанавливает значения полей
   - Показывает сообщение об успехе (уже на новом языке!)

## Тестирование

Запустите тест:
```bash
python test_language_switching.py
```

Или вручную:
1. Откройте настройки
2. Перейдите на вкладку "Языки"
3. Выберите другой язык (например, English)
4. Нажмите "Сохранить"
5. Интерфейс должен обновиться на выбранный язык

## Ограничения

- Обновляется только окно настроек
- Для обновления других окон (tray icon, floating window) требуется перезапуск приложения
- Это будет реализовано в следующих задачах

## Следующие шаги

- [ ] Обновление tray icon при смене языка
- [ ] Обновление floating window при смене языка
- [ ] Добавление сигнала для уведомления всех компонентов о смене языка
- [ ] Написание property-based тестов для динамического переключения
