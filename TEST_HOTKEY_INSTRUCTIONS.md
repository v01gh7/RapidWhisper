# Инструкция по тестированию HotkeyInput

## Что исправлено

### Проблема 1: Ctrl+J не работал
**Исправлено**: Теперь все буквы A-Z корректно работают с модификаторами

### Проблема 2: Поле не теряло фокус
**Исправлено**: После выбора клавиши поле автоматически теряет фокус

## Как протестировать

### 1. Запустите тестовое окно
```bash
uv run python test_hotkey_input.py
```

### 2. Проверьте базовые сочетания

#### Тест 1: Ctrl+J
1. Кликните на поле
2. Нажмите `Ctrl+J`
3. ✅ Должно появиться: `ctrl+j`
4. ✅ Поле должно потерять фокус (не выделено)

#### Тест 2: Ctrl+Space
1. Кликните на поле
2. Нажмите `Ctrl+Space`
3. ✅ Должно появиться: `ctrl+space`
4. ✅ Поле должно потерять фокус

#### Тест 3: F1
1. Кликните на поле
2. Нажмите `F1`
3. ✅ Должно появиться: `f1`
4. ✅ Поле должно потерять фокус

#### Тест 4: Ctrl+Shift+R
1. Кликните на поле
2. Нажмите `Ctrl+Shift+R`
3. ✅ Должно появиться: `ctrl+shift+r`
4. ✅ Поле должно потерять фокус

### 3. Проверьте автоматическую потерю фокуса

#### Тест 5: Последовательные нажатия
1. Кликните на поле
2. Нажмите `Ctrl+A` → появится `ctrl+a`, поле потеряет фокус
3. Нажмите `Ctrl+B` → **ничего не должно произойти** (поле не в фокусе)
4. Кликните на поле снова
5. Нажмите `Ctrl+C` → появится `ctrl+c`, заменит предыдущее значение
6. ✅ Каждое нажатие требует нового клика на поле

### 4. Проверьте все буквы

#### Тест 6: Все буквы с Ctrl
Попробуйте:
- `Ctrl+A` → `ctrl+a` ✅
- `Ctrl+B` → `ctrl+b` ✅
- `Ctrl+J` → `ctrl+j` ✅
- `Ctrl+Z` → `ctrl+z` ✅

### 5. Проверьте цифры

#### Тест 7: Цифры с модификаторами
- `Ctrl+1` → `ctrl+1` ✅
- `Ctrl+9` → `ctrl+9` ✅
- `Shift+5` → `shift+5` ✅

### 6. Проверьте в настройках приложения

#### Тест 8: Реальное использование
1. Закройте тестовое окно
2. Откройте RapidWhisper (если не запущен)
3. Откройте настройки (трей → Настройки)
4. Перейдите в "Приложение"
5. Кликните на поле "Горячая клавиша"
6. Нажмите `Ctrl+J`
7. ✅ Должно появиться: `ctrl+j`
8. ✅ Поле должно потерять фокус
9. Нажмите "Сохранить"
10. ✅ Настройки должны сохраниться

## Ожидаемое поведение

### ✅ Правильно:
1. Кликнули на поле → поле в фокусе (выделено)
2. Нажали сочетание → сочетание записалось
3. Поле автоматически потеряло фокус (не выделено)
4. Следующее нажатие клавиш **не влияет** на поле
5. Нужно снова кликнуть на поле для изменения

### ❌ Неправильно:
1. После записи сочетания поле остается в фокусе
2. Следующее нажатие клавиш перезаписывает значение
3. Ctrl+J не работает или записывается неправильно

## Если что-то не работает

### Проблема: Ctrl+J все еще не работает
**Решение**: 
- Убедитесь, что файл `ui/hotkey_input.py` обновлен
- Перезапустите приложение/тест

### Проблема: Поле не теряет фокус
**Решение**:
- Проверьте, что в `keyPressEvent` есть строка `self.clearFocus()`
- Перезапустите приложение/тест

### Проблема: Значение перезаписывается
**Решение**:
- Это нормально, если поле в фокусе
- После записи поле должно терять фокус автоматически
- Если не теряет - см. выше

## Консольный вывод

При тестировании в консоли должны появляться сообщения:
```
Новая горячая клавиша: ctrl+j
Новая горячая клавиша: ctrl+space
Новая горячая клавиша: f1
```

Это подтверждает, что сигнал `hotkey_changed` работает корректно.
