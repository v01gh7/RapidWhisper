# HTML –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Word/Google Docs/LibreOffice

## –ü—Ä–æ–±–ª–µ–º–∞

–†–∞–Ω—å—à–µ –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—É—á–∞–ª–∏ **markdown —Å–∏–º–≤–æ–ª—ã** (`# ## ***`), –∫–æ—Ç–æ—Ä—ã–µ:
- ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç –≤ Notion, Obsidian, Markdown —Ñ–∞–π–ª–∞—Ö
- ‚ùå –ù–ï —Ä–∞–±–æ—Ç–∞—é—Ç –≤ Word, Google Docs, LibreOffice (–ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç —Å —Å–∏–º–≤–æ–ª–∞–º–∏)

## –†–µ—à–µ–Ω–∏–µ

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π:

### 1. Markdown-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Notion, Obsidian, Markdown, VSCode)
**–ü—Ä–æ–º–ø—Ç**: `MARKDOWN_FORMATTING_PROMPT`
**–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞**: Markdown —Å–∏–º–≤–æ–ª—ã
```markdown
# –ó–∞–≥–æ–ª–æ–≤–æ–∫ 1
## –ó–∞–≥–æ–ª–æ–≤–æ–∫ 2
**–∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç**
- —Å–ø–∏—Å–æ–∫
```

### 2. Word/LibreOffice/Google Docs
**–ü—Ä–æ–º–ø—Ç**: `HTML_FORMATTING_PROMPT`
**–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞**: HTML —Ç–µ–≥–∏
```html
<h1>–ó–∞–≥–æ–ª–æ–≤–æ–∫ 1</h1>
<h2>–ó–∞–≥–æ–ª–æ–≤–æ–∫ 2</h2>
<strong>–∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç</strong>
<ul><li>—Å–ø–∏—Å–æ–∫</li></ul>
```

**–í—Å—Ç–∞–≤–∫–∞**: HTML –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ —á–µ—Ä–µ–∑ `RichClipboardManager`
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: Word/Google Docs –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ!

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```python
format_type = self.get_active_application_format()
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: "word", "notion", "obsidian", "markdown", –∏ —Ç.–¥.
```

### 2. –í—ã–±–æ—Ä –ø—Ä–æ–º–ø—Ç–∞
```python
prompt = self.config.get_prompt_for_app(format_type)
# word/libreoffice ‚Üí HTML_FORMATTING_PROMPT
# notion/obsidian ‚Üí MARKDOWN_FORMATTING_PROMPT
```

### 3. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
AI –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–æ–º–ø—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
- –î–ª—è Word: `<h1>–ó–∞–≥–æ–ª–æ–≤–æ–∫</h1><p>–¢–µ–∫—Å—Ç</p>`
- –î–ª—è Notion: `# –ó–∞–≥–æ–ª–æ–≤–æ–∫\n\n–¢–µ–∫—Å—Ç`

### 4. –í—Å—Ç–∞–≤–∫–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
```python
if format_output_type == "html":
    RichClipboardManager.copy_html_to_clipboard(formatted_text, plain_text)
else:
    # –û–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç (markdown)
    pyperclip.copy(formatted_text)
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### RichClipboardManager
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç `win32clipboard` –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ HTML –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ Windows:
- –°–æ–∑–¥–∞–µ—Ç HTML –¥–æ–∫—É–º–µ–Ω—Ç —Å CSS —Å—Ç–∏–ª—è–º–∏
- –î–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∞ Windows
- –í—Å—Ç–∞–≤–ª—è–µ—Ç –∏ HTML, –∏ plain text (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)

### –§–æ—Ä–º–∞—Ç HTML –¥–ª—è –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞
```
Version:0.9
StartHTML:0000000105
EndHTML:0000000456
StartFragment:0000000140
EndFragment:0000000420
<!DOCTYPE html>
<html>
<head>
<style>
h1 { font-size: 18pt; font-weight: bold; }
...
</style>
</head>
<body>
<h1>–í–∞—à —Ç–µ–∫—Å—Ç</h1>
</body>
</html>
```

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –∫–æ–¥–µ

### 1. `services/formatting_config.py`
- –î–æ–±–∞–≤–ª–µ–Ω—ã `MARKDOWN_FORMATTING_PROMPT` –∏ `HTML_FORMATTING_PROMPT`
- –ú–µ—Ç–æ–¥ `get_prompt_for_app()` –≤—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç
- –ú–µ—Ç–æ–¥ `get_format_type()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç "html" –∏–ª–∏ "markdown"

### 2. `services/rich_clipboard_manager.py` (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
- –ö–ª–∞—Å—Å `RichClipboardManager` –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ HTML
- –ú–µ—Ç–æ–¥ `copy_html_to_clipboard()` —Å fallback –Ω–∞ plain text

### 3. `services/formatting_module.py`
- –ú–µ—Ç–æ–¥ `process()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∏–ø —Ñ–æ—Ä–º–∞—Ç–∞
- –î–ª—è HTML –≤—ã–∑—ã–≤–∞–µ—Ç `RichClipboardManager.copy_html_to_clipboard()`

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–º–ø—Ç—ã
```bash
python update_prompts_for_html.py
```

### 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
- **Google Docs**: –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –∑–∞–ø–∏—à–∏—Ç–µ –≥–æ–ª–æ—Å, –≤—Å—Ç–∞–≤—å—Ç–µ (Ctrl+V)
  - –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –†–ï–ê–õ–¨–ù–´–ú–ò –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ (–∫—Ä—É–ø–Ω—ã–π —à—Ä–∏—Ñ—Ç)
  - –ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ñ–ò–†–ù–´–ú
  - –°–ø–∏—Å–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –°–ü–ò–°–ö–ê–ú–ò
  
- **Word/LibreOffice**: –¢–æ –∂–µ —Å–∞–º–æ–µ!

- **Notion/Obsidian**: Markdown —Å–∏–º–≤–æ–ª—ã (# ** *)

## –û—Ç–ª–∞–¥–∫–∞

–õ–æ–≥–∏ –ø–æ–∫–∞–∂—É—Ç:
```
‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω —Ñ–æ—Ä–º–∞—Ç: word
–¢–∏–ø –≤—ã–≤–æ–¥–∞: html
üìã –í—Å—Ç–∞–≤–∫–∞ HTML –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ –¥–ª—è Word/Google Docs/LibreOffice
‚úÖ HTML —É—Å–ø–µ—à–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
```

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–¢–æ–ª—å–∫–æ Windows**: `win32clipboard` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ Windows
2. **–¢—Ä–µ–±—É–µ—Ç—Å—è pywin32**: –£–∂–µ –µ—Å—Ç—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö
3. **–ë—Ä–∞—É–∑–µ—Ä—ã**: Google Docs –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É –≤–∫–ª–∞–¥–∫–∏ (—Å–º. `BROWSER_TITLE_MAPPINGS`)

## FAQ

**Q: –ü–æ—á–µ–º—É –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è RTF?**
A: HTML –ø—Ä–æ—â–µ –∏ –ª—É—á—à–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏.

**Q: –ß—Ç–æ –µ—Å–ª–∏ HTML –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç?**
A: –ï—Å—Ç—å fallback –Ω–∞ plain text (–±–µ–∑ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è).

**Q: –ú–æ–∂–Ω–æ –ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å HTML —Å—Ç–∏–ª–∏?**
A: –î–∞, —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `_create_html_clipboard_format()` –≤ `RichClipboardManager`.

**Q: –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –≤ LibreOffice?**
A: –î–∞! LibreOffice –ø–æ–Ω–∏–º–∞–µ—Ç HTML –∏–∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞.
